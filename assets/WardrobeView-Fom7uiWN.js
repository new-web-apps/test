import{z as k,x as R,y as I,A as B,D as C,E,G as F,B as M,C as P,H as q,d as A,u as L,I as W,r as p,l as $,o as i,c as u,f as H,w as N,v as T,a as d,m as U,t as h,F as j,n as z,J as G,p as J,q as K,_ as O}from"./index-BzzMiSTW.js";var a=[];for(var b=0;b<256;++b)a.push((b+256).toString(16).slice(1));function Q(o,e=0){return(a[o[e+0]]+a[o[e+1]]+a[o[e+2]]+a[o[e+3]]+"-"+a[o[e+4]]+a[o[e+5]]+"-"+a[o[e+6]]+a[o[e+7]]+"-"+a[o[e+8]]+a[o[e+9]]+"-"+a[o[e+10]]+a[o[e+11]]+a[o[e+12]]+a[o[e+13]]+a[o[e+14]]+a[o[e+15]]).toLowerCase()}var m,X=new Uint8Array(16);function Y(){if(!m&&(m=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!m))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return m(X)}var Z=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const f={randomUUID:Z};function ee(o,e,c){if(f.randomUUID&&!e&&!o)return f.randomUUID();o=o||{};var t=o.random||(o.rng||Y)();return t[6]=t[6]&15|64,t[8]=t[8]&63|128,Q(t)}const oe=async o=>{const e=ee(),c=C(q,e);let t="";try{await E(c,o.photo),console.log("Uploaded a blob or file!"),t=await F(c),console.log("save photo to storage")}catch(l){console.log(l),console.log("error save photo to storage");return}try{await M(P(I,`userData/${o.email}/wardrobeData`,e),{id:e,description:o.description,url:t}),console.log("save photo to db")}catch{console.log("error save photo to db");return}},ae=async o=>{const e=k(R(I,`userData/${o}/wardrobeData`)),c=await B(e);let t=[];return c.forEach(l=>{const v=l.data();console.log(l.id," => ",v),t.push(v)}),t},w=o=>(J("data-v-94506cd0"),o=o(),K(),o),te={class:"wardrobe"},se=w(()=>d("h1",null,"wardrobe",-1)),ne=w(()=>d("h3",null,"Form Add Photo",-1)),le=["disabled"],re={key:0},de={class:"errorMessage"},ce=w(()=>d("h3",null,"Wardrobe",-1)),ie={key:0},ue={key:1},ve=["src"],pe=A({__name:"WardrobeView",setup(o){const e=L(),c=G(),t=W(()=>{var s,r;return((s=e==null?void 0:e.user)==null?void 0:s.email)===((r=c==null?void 0:c.params)==null?void 0:r.email)}),l=p(null),v=p("");function S(s){s.target.files[0]&&(l.value=s.target.files[0])}const y=p(!1),_=p(""),D=p(0);function x(){l.value=null,v.value="",D.value++}async function V(){var s;if(console.log("addPhoto"),!!l.value){y.value=!0,_.value="";try{await oe({photo:l.value,description:v.value,email:(s=e==null?void 0:e.user)==null?void 0:s.email}),x()}catch(r){console.log(r),_.value=r==null?void 0:r.message}y.value=!1}}const g=p(null);return $(async()=>{var s;g.value=await ae((s=e==null?void 0:e.user)==null?void 0:s.email),console.log("photos",g.value)}),(s,r)=>(i(),u("div",te,[se,t.value?(i(),u("form",{key:0,onSubmit:H(V,["prevent"]),class:"add-photo-form"},[ne,(i(),u("input",{type:"file",onChange:S,key:D.value},null,32)),N(d("input",{"onUpdate:modelValue":r[0]||(r[0]=n=>v.value=n),placeholder:"description"},null,512),[[T,v.value]]),d("button",{disabled:!l.value||s.loaging},"Add photo",8,le),y.value?(i(),u("div",re,"Loading...")):U("",!0),d("div",de,h(_.value),1)],32)):U("",!0),d("div",null,[ce,g.value?(i(),u("div",ue,[(i(!0),u(j,null,z(g.value,n=>(i(),u("div",{key:n},[d("div",null,"# "+h(n==null?void 0:n.id),1),d("img",{src:n==null?void 0:n.url},null,8,ve),d("div",null,h(n==null?void 0:n.description),1)]))),128))])):(i(),u("div",ie))])]))}}),me=O(pe,[["__scopeId","data-v-94506cd0"]]);export{me as default};
